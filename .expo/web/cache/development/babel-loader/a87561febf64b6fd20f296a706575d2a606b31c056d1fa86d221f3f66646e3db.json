{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.and = and;\nexports.deleteDoc = deleteDoc;\nexports.endAt = endAt;\nexports.endBefore = endBefore;\nexports.getDocs = getDocs;\nexports.getDocsFromCache = getDocsFromCache;\nexports.getDocsFromServer = getDocsFromServer;\nexports.limit = limit;\nexports.limitToLast = limitToLast;\nexports.or = or;\nexports.orderBy = orderBy;\nexports.query = query;\nexports.startAfter = startAfter;\nexports.startAt = startAt;\nexports.where = where;\nvar _construct2 = _interopRequireDefault(require(\"@babel/runtime/helpers/construct\"));\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar _FirestoreFilter = require(\"../FirestoreFilter\");\nvar QueryConstraint = function () {\n  function QueryConstraint(type) {\n    (0, _classCallCheck2.default)(this, QueryConstraint);\n    this.type = type;\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    this._args = args;\n  }\n  (0, _createClass2.default)(QueryConstraint, [{\n    key: \"_apply\",\n    value: function _apply(query) {\n      return query[this.type].apply(query, this._args);\n    }\n  }]);\n  return QueryConstraint;\n}();\nfunction query(query, queryConstraint) {\n  for (var _len2 = arguments.length, additionalQueryConstraints = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n    additionalQueryConstraints[_key2 - 2] = arguments[_key2];\n  }\n  var queryConstraints = [queryConstraint].concat(additionalQueryConstraints).filter(function (constraint) {\n    return constraint !== undefined;\n  });\n  var q = query;\n  for (var _queryConstraint of queryConstraints) {\n    q = _queryConstraint._apply(q);\n  }\n  return q;\n}\nfunction where(fieldPath, opStr, value) {\n  return new QueryConstraint('where', fieldPath, opStr, value);\n}\nfunction getFilterOps(queries) {\n  var ops = [];\n  for (var _query of queries) {\n    if (_query.type !== 'where') {\n      throw 'Not where';\n    }\n    var args = _query._args;\n    if (!args.length) {\n      throw 'No args';\n    }\n    if (args[0] instanceof _FirestoreFilter._Filter) {\n      ops.push(args[0]);\n      continue;\n    }\n    var _args = (0, _slicedToArray2.default)(args, 3),\n      fieldPath = _args[0],\n      opStr = _args[1],\n      value = _args[2];\n    ops.push((0, _FirestoreFilter.Filter)(fieldPath, opStr, value));\n  }\n  return ops;\n}\nfunction or() {\n  for (var _len3 = arguments.length, queries = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n    queries[_key3] = arguments[_key3];\n  }\n  var ops = getFilterOps(queries);\n  return new QueryConstraint('where', _FirestoreFilter.Filter.or.apply(_FirestoreFilter.Filter, (0, _toConsumableArray2.default)(ops)));\n}\nfunction and() {\n  for (var _len4 = arguments.length, queries = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n    queries[_key4] = arguments[_key4];\n  }\n  var ops = getFilterOps(queries);\n  return new QueryConstraint('where', _FirestoreFilter.Filter.and.apply(_FirestoreFilter.Filter, (0, _toConsumableArray2.default)(ops)));\n}\nfunction orderBy(fieldPath, directionStr) {\n  return new QueryConstraint('orderBy', fieldPath, directionStr);\n}\nfunction startAt() {\n  for (var _len5 = arguments.length, docOrFields = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    docOrFields[_key5] = arguments[_key5];\n  }\n  return (0, _construct2.default)(QueryConstraint, ['startAt'].concat(docOrFields));\n}\nfunction startAfter() {\n  for (var _len6 = arguments.length, docOrFields = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n    docOrFields[_key6] = arguments[_key6];\n  }\n  return (0, _construct2.default)(QueryConstraint, ['startAfter'].concat(docOrFields));\n}\nfunction endAt(value, key) {\n  if (!key) {\n    return new QueryConstraint('endAt', value);\n  }\n  return new QueryConstraint('endAt', value, key);\n}\nfunction endBefore(value, key) {\n  if (!key) {\n    return new QueryConstraint('endBefore', value);\n  }\n  return new QueryConstraint('endBefore', value, key);\n}\nfunction limit(limit) {\n  return new QueryConstraint('limit', limit);\n}\nfunction limitToLast(limit) {\n  return new QueryConstraint('limitToLast', limit);\n}\nfunction getDocs(query) {\n  return query.get({\n    source: 'default'\n  });\n}\nfunction getDocsFromCache(query) {\n  return query.get({\n    source: 'cache'\n  });\n}\nfunction getDocsFromServer(query) {\n  return query.get({\n    source: 'server'\n  });\n}\nfunction deleteDoc(reference) {\n  return reference.delete();\n}","map":{"version":3,"names":["_FirestoreFilter","require","QueryConstraint","type","_classCallCheck2","default","_len","arguments","length","args","Array","_key","_args","_createClass2","key","value","_apply","query","apply","queryConstraint","_len2","additionalQueryConstraints","_key2","queryConstraints","concat","filter","constraint","undefined","q","where","fieldPath","opStr","getFilterOps","queries","ops","_Filter","push","_slicedToArray2","Filter","or","_len3","_key3","_toConsumableArray2","and","_len4","_key4","orderBy","directionStr","startAt","_len5","docOrFields","_key5","_construct2","startAfter","_len6","_key6","endAt","endBefore","limit","limitToLast","getDocs","get","source","getDocsFromCache","getDocsFromServer","deleteDoc","reference","delete"],"sources":["C:/ReactNative/DemoFireBase/node_modules/@react-native-firebase/firestore/lib/modular/query.js"],"sourcesContent":["/**\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentReference} DocumentReference\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentSnapshot} DocumentSnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.FieldPath} FieldPath\n * @typedef {import('..').FirebaseFirestoreTypes.QueryCompositeFilterConstraint} QueryCompositeFilterConstraint\n * @typedef {import('..').FirebaseFirestoreTypes.QuerySnapshot} QuerySnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.Query} Query\n * @typedef {import('..').FirebaseFirestoreTypes.WhereFilterOp} WhereFilterOp\n * @typedef {import('../FirestoreFilter')._Filter} _Filter\n * @typedef {import('./query').IQueryConstraint} IQueryConstraint\n * @typedef {import('./query').OrderByDirection} OrderByDirection\n * @typedef {import('./query').QueryFieldFilterConstraint} QueryFieldFilterConstraint\n * @typedef {import('./query').QueryLimitConstraint} QueryLimitConstraint\n * @typedef {import('./query').QueryNonFilterConstraint} QueryNonFilterConstraint\n * @typedef {import('./query').QueryOrderByConstraint} QueryOrderByConstraint\n * @typedef {import('./query').QueryStartAtConstraint} QueryStartAtConstraint\n */\n\nimport { _Filter, Filter } from '../FirestoreFilter';\n\n/**\n * @implements {IQueryConstraint}\n */\nclass QueryConstraint {\n  constructor(type, ...args) {\n    this.type = type;\n    this._args = args;\n  }\n\n  _apply(query) {\n    return query[this.type].apply(query, this._args);\n  }\n}\n\n/**\n * @param {Query} query\n * @param {QueryCompositeFilterConstraint | QueryConstraint | undefined} queryConstraint\n * @param {(QueryConstraint | QueryNonFilterConstraint)[]} additionalQueryConstraints\n * @returns {Query}\n */\nexport function query(query, queryConstraint, ...additionalQueryConstraints) {\n  const queryConstraints = [queryConstraint, ...additionalQueryConstraints].filter(\n    constraint => constraint !== undefined,\n  );\n  let q = query;\n  for (const queryConstraint of queryConstraints) {\n    q = queryConstraint._apply(q);\n  }\n  return q;\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {WhereFilterOp} opStr\n * @param {unknown} value\n * @returns {QueryFieldFilterConstraint}\n */\nexport function where(fieldPath, opStr, value) {\n  return new QueryConstraint('where', fieldPath, opStr, value);\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {_Filter[]}\n */\nfunction getFilterOps(queries) {\n  const ops = [];\n  for (const query of queries) {\n    if (query.type !== 'where') {\n      throw 'Not where'; // FIXME: Better error message\n    }\n\n    const args = query._args;\n    if (!args.length) {\n      throw 'No args'; // FIXME: Better error message\n    }\n\n    if (args[0] instanceof _Filter) {\n      ops.push(args[0]);\n      continue;\n    }\n\n    const [fieldPath, opStr, value] = args;\n    ops.push(Filter(fieldPath, opStr, value));\n  }\n  return ops;\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function or(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.or(...ops));\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function and(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.and(...ops));\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {OrderByDirection} directionStr\n * @returns {QueryOrderByConstraint}\n */\nexport function orderBy(fieldPath, directionStr) {\n  return new QueryConstraint('orderBy', fieldPath, directionStr);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAt(...docOrFields) {\n  return new QueryConstraint('startAt', ...docOrFields);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAfter(...docOrFields) {\n  return new QueryConstraint('startAfter', ...docOrFields);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endAt(value, key) {\n  if (!key) {\n    return new QueryConstraint('endAt', value);\n  }\n  return new QueryConstraint('endAt', value, key);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endBefore(value, key) {\n  if (!key) {\n    return new QueryConstraint('endBefore', value);\n  }\n  return new QueryConstraint('endBefore', value, key);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryLimitConstraint}\n */\nexport function limit(limit) {\n  return new QueryConstraint('limit', limit);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryConstraint}\n */\nexport function limitToLast(limit) {\n  return new QueryConstraint('limitToLast', limit);\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocs(query) {\n  return query.get({ source: 'default' });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromCache(query) {\n  return query.get({ source: 'cache' });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromServer(query) {\n  return query.get({ source: 'server' });\n}\n\n/**\n * @param {DocumentReference} reference\n * @returns {Promise<void>}\n */\nexport function deleteDoc(reference) {\n  return reference.delete();\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}