{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Filter = Filter;\nexports._Filter = _Filter;\nexports.generateFilters = generateFilters;\nvar _common = require(\"@react-native-firebase/app/lib/common\");\nvar _FirestoreFieldPath = require(\"./FirestoreFieldPath\");\nvar _serialize = require(\"./utils/serialize\");\nvar _FirestoreQueryModifiers = require(\"./FirestoreQueryModifiers\");\nvar AND_QUERY = 'AND';\nvar OR_QUERY = 'OR';\nfunction Filter(fieldPath, operator, value) {\n  return new _Filter(fieldPath, operator, value);\n}\nfunction _Filter(fieldPath, operator, value, filterOperator, queries) {\n  if ([AND_QUERY, OR_QUERY].includes(filterOperator)) {\n    this.operator = filterOperator;\n    this.queries = queries;\n    this._toMap = function _toMap() {\n      return {\n        operator: this.operator,\n        queries: this.queries.map(function (query) {\n          return query._toMap();\n        })\n      };\n    };\n    return this;\n  } else {\n    this.fieldPath = fieldPath;\n    this.operator = operator;\n    this.value = value;\n    this._toMap = function _toMap() {\n      return {\n        fieldPath: this.fieldPath,\n        operator: this.operator,\n        value: this.value\n      };\n    };\n    return this;\n  }\n}\nFilter.and = function and() {\n  for (var _len = arguments.length, queries = new Array(_len), _key = 0; _key < _len; _key++) {\n    queries[_key] = arguments[_key];\n  }\n  if (queries.length > 10 || queries.length < 2) {\n    throw new Error(`Expected 2-10 instances of Filter, but got ${queries.length} Filters`);\n  }\n  var validateFilters = queries.every(function (filter) {\n    return filter instanceof _Filter;\n  });\n  if (!validateFilters) {\n    throw new Error('Expected every argument to be an instance of Filter');\n  }\n  return new _Filter(null, null, null, AND_QUERY, queries);\n};\nfunction hasOrOperator(obj) {\n  return obj.operator === 'OR' || Array.isArray(obj.queries) && obj.queries.some(hasOrOperator);\n}\nFilter.or = function or() {\n  for (var _len2 = arguments.length, queries = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    queries[_key2] = arguments[_key2];\n  }\n  if (queries.length > 10 || queries.length < 2) {\n    throw new Error(`Expected 2-10 instances of Filter, but got ${queries.length} Filters`);\n  }\n  var validateFilters = queries.every(function (filter) {\n    return filter instanceof _Filter;\n  });\n  if (!validateFilters) {\n    throw new Error('Expected every argument to be an instance of Filter');\n  }\n  var hasOr = queries.some(hasOrOperator);\n  if (hasOr) {\n    throw new Error('OR Filters with nested OR Filters are not supported');\n  }\n  return new _Filter(null, null, null, OR_QUERY, queries);\n};\nfunction mapFieldQuery(_ref, modifiers) {\n  var fieldPath = _ref.fieldPath,\n    operator = _ref.operator,\n    value = _ref.value,\n    queries = _ref.queries;\n  if (operator === AND_QUERY || operator === OR_QUERY) {\n    return {\n      operator: operator,\n      queries: queries.map(function (filter) {\n        return mapFieldQuery(filter, modifiers);\n      })\n    };\n  }\n  var path;\n  if ((0, _common.isString)(fieldPath)) {\n    try {\n      path = (0, _FirestoreFieldPath.fromDotSeparatedString)(fieldPath);\n    } catch (e) {\n      throw new Error(`first argument of Filter(*,_ , _) 'fieldPath' ${e.message}.`);\n    }\n  } else {\n    path = fieldPath;\n  }\n  if (!modifiers.isValidOperator(operator)) {\n    throw new Error(\"second argument of Filter(*,_ , _) 'opStr' is invalid. Expected one of '==', '>', '>=', '<', '<=', '!=', 'array-contains', 'not-in', 'array-contains-any' or 'in'.\");\n  }\n  if ((0, _common.isUndefined)(value)) {\n    throw new Error(\"third argument of Filter(*,_ , _) 'value' argument expected.\");\n  }\n  if ((0, _common.isNull)(value) && !modifiers.isEqualOperator(operator) && !modifiers.isNotEqualOperator(operator)) {\n    throw new Error(\"third argument of Filter(*,_ , _) 'value' is invalid. You can only perform equals comparisons on null\");\n  }\n  if (modifiers.isInOperator(operator)) {\n    if (!(0, _common.isArray)(value) || !value.length) {\n      throw new Error(`third argument of Filter(*,_ , _) 'value' is invalid. A non-empty array is required for '${operator}' filters.`);\n    }\n    if (value.length > 10) {\n      throw new Error(`third argument of Filter(*,_ , _) 'value' is invalid. '${operator}' filters support a maximum of 10 elements in the value array.`);\n    }\n  }\n  return {\n    fieldPath: path,\n    operator: _FirestoreQueryModifiers.OPERATORS[operator],\n    value: (0, _serialize.generateNativeData)(value, true)\n  };\n}\nfunction generateFilters(filter, modifiers) {\n  var filterMap = filter._toMap();\n  var queriesMaps = filterMap.queries.map(function (filter) {\n    return mapFieldQuery(filter, modifiers);\n  });\n  return {\n    operator: filterMap.operator,\n    queries: queriesMaps\n  };\n}","map":{"version":3,"names":["_common","require","_FirestoreFieldPath","_serialize","_FirestoreQueryModifiers","AND_QUERY","OR_QUERY","Filter","fieldPath","operator","value","_Filter","filterOperator","queries","includes","_toMap","map","query","and","_len","arguments","length","Array","_key","Error","validateFilters","every","filter","hasOrOperator","obj","isArray","some","or","_len2","_key2","hasOr","mapFieldQuery","_ref","modifiers","path","isString","fromDotSeparatedString","e","message","isValidOperator","isUndefined","isNull","isEqualOperator","isNotEqualOperator","isInOperator","OPERATORS","generateNativeData","generateFilters","filterMap","queriesMaps"],"sources":["C:/ReactNative/DemoFireBase/node_modules/@react-native-firebase/firestore/lib/FirestoreFilter.js"],"sourcesContent":["import { isString, isNull, isUndefined, isArray } from '@react-native-firebase/app/lib/common';\nimport { fromDotSeparatedString } from './FirestoreFieldPath';\nimport { generateNativeData } from './utils/serialize';\nimport { OPERATORS } from './FirestoreQueryModifiers';\nconst AND_QUERY = 'AND';\nconst OR_QUERY = 'OR';\n\nexport function Filter(fieldPath, operator, value) {\n  return new _Filter(fieldPath, operator, value);\n}\n\nexport function _Filter(fieldPath, operator, value, filterOperator, queries) {\n  if ([AND_QUERY, OR_QUERY].includes(filterOperator)) {\n    // AND or OR Filter (list of Filters)\n    this.operator = filterOperator;\n    this.queries = queries;\n\n    this._toMap = function _toMap() {\n      return {\n        operator: this.operator,\n        queries: this.queries.map(query => query._toMap()),\n      };\n    };\n\n    return this;\n  } else {\n    // Filter\n    this.fieldPath = fieldPath;\n    this.operator = operator;\n    this.value = value;\n\n    this._toMap = function _toMap() {\n      return {\n        fieldPath: this.fieldPath,\n        operator: this.operator,\n        value: this.value,\n      };\n    };\n\n    return this;\n  }\n}\n\nFilter.and = function and(...queries) {\n  if (queries.length > 10 || queries.length < 2) {\n    throw new Error(`Expected 2-10 instances of Filter, but got ${queries.length} Filters`);\n  }\n\n  const validateFilters = queries.every(filter => filter instanceof _Filter);\n\n  if (!validateFilters) {\n    throw new Error('Expected every argument to be an instance of Filter');\n  }\n\n  return new _Filter(null, null, null, AND_QUERY, queries);\n};\n\nfunction hasOrOperator(obj) {\n  return obj.operator === 'OR' || (Array.isArray(obj.queries) && obj.queries.some(hasOrOperator));\n}\n\nFilter.or = function or(...queries) {\n  if (queries.length > 10 || queries.length < 2) {\n    throw new Error(`Expected 2-10 instances of Filter, but got ${queries.length} Filters`);\n  }\n\n  const validateFilters = queries.every(filter => filter instanceof _Filter);\n\n  if (!validateFilters) {\n    throw new Error('Expected every argument to be an instance of Filter');\n  }\n\n  const hasOr = queries.some(hasOrOperator);\n\n  if (hasOr) {\n    throw new Error('OR Filters with nested OR Filters are not supported');\n  }\n\n  return new _Filter(null, null, null, OR_QUERY, queries);\n};\n\nfunction mapFieldQuery({ fieldPath, operator, value, queries }, modifiers) {\n  if (operator === AND_QUERY || operator === OR_QUERY) {\n    return {\n      operator,\n      queries: queries.map(filter => mapFieldQuery(filter, modifiers)),\n    };\n  }\n\n  let path;\n  if (isString(fieldPath)) {\n    try {\n      path = fromDotSeparatedString(fieldPath);\n    } catch (e) {\n      throw new Error(`first argument of Filter(*,_ , _) 'fieldPath' ${e.message}.`);\n    }\n  } else {\n    path = fieldPath;\n  }\n\n  if (!modifiers.isValidOperator(operator)) {\n    throw new Error(\n      \"second argument of Filter(*,_ , _) 'opStr' is invalid. Expected one of '==', '>', '>=', '<', '<=', '!=', 'array-contains', 'not-in', 'array-contains-any' or 'in'.\",\n    );\n  }\n\n  if (isUndefined(value)) {\n    throw new Error(\"third argument of Filter(*,_ , _) 'value' argument expected.\");\n  }\n\n  if (\n    isNull(value) &&\n    !modifiers.isEqualOperator(operator) &&\n    !modifiers.isNotEqualOperator(operator)\n  ) {\n    throw new Error(\n      \"third argument of Filter(*,_ , _) 'value' is invalid. You can only perform equals comparisons on null\",\n    );\n  }\n\n  if (modifiers.isInOperator(operator)) {\n    if (!isArray(value) || !value.length) {\n      throw new Error(\n        `third argument of Filter(*,_ , _) 'value' is invalid. A non-empty array is required for '${operator}' filters.`,\n      );\n    }\n\n    if (value.length > 10) {\n      throw new Error(\n        `third argument of Filter(*,_ , _) 'value' is invalid. '${operator}' filters support a maximum of 10 elements in the value array.`,\n      );\n    }\n  }\n\n  return {\n    fieldPath: path,\n    operator: OPERATORS[operator],\n    value: generateNativeData(value, true),\n  };\n}\n\nexport function generateFilters(filter, modifiers) {\n  const filterMap = filter._toMap();\n\n  const queriesMaps = filterMap.queries.map(filter => mapFieldQuery(filter, modifiers));\n\n  return {\n    operator: filterMap.operator,\n    queries: queriesMaps,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}